<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Debrief</title>
  <link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>

  <meta http-equiv="X-UA-Compatible" content="chrome=1"/>
  <script src="/js/jquery-2.1.3.min.js"></script>
  <script type="text/javascript" src="/_ah/channel/jsapi"></script>
  <link rel="stylesheet" href="css/video.css" />
  <!-- Load the polyfill to switch-hit between Chrome and Firefox -->
  <script src="/js/adapter.js"></script>

</head>
<body>
  <script src="/dist/bundle.js"></script>

  <script>
    function onUserMediaSuccess(stream) {
      var element = document.getElementById('localVideo');
      if (typeof element.srcObject !== 'undefined') {
        element.srcObject = stream;
      } else if (typeof element.mozSrcObject !== 'undefined') {
        element.mozSrcObject = stream;
      } else if (typeof element.src !== 'undefined') {
        element.src = URL.createObjectURL(stream);
      } else {
        alert('Error attaching stream to element.');
      }
    }

    function onUserMediaError(stream) {
      alert("success");
    }

    navigator.getUserMedia  = navigator.getUserMedia ||
                        navigator.webkitGetUserMedia ||
                        navigator.mozGetUserMedia ||
                        navigator.msGetUserMedia;
    window.AudioContext = window.AudioContext ||
                        window.webkitAudioContext;   
    navigator.getUserMedia({audio: true, video: true}, onUserMediaSuccess, onUserMediaError);

  </script>
  <script type="text/javascript">
    var errorMessages = {{ error_messages }};
    var channelToken = '{{ token }}';
    var me = '{{ me }}';
    var roomKey = '{{ room_key }}';
    var roomLink = '{{ room_link }}';
    var initiator = {{ initiator }};
    var pcConfig = {{ pc_config | safe }};
    var pcConstraints = {{ pc_constraints | safe }};
    var offerConstraints = {{ offer_constraints | safe }};
    var mediaConstraints = {{ media_constraints | safe }};
    var turnUrl = '{{ turn_url }}';
    var stereo = {{ stereo }};
    var audio_send_codec = '{{ audio_send_codec }}';
    var audio_receive_codec = '{{ audio_receive_codec }}';
    setTimeout(initialize, 1);
  </script>
</body>
</html>